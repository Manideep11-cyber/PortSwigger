# Lab Walkthrough — Exploiting API Documentation (Apprentice)


**Target lab:** PortSwigger — *Exploiting an API endpoint using documentation* (Apprentice)


**Access:** Log in with `wiener:peter` (use Burp's browser)


---


## Objective
Find exposed API documentation and use it to delete user `carlos`.


---


## Tools
- Burp Suite (Proxy, HTTP history, Repeater, Browser)
- Burp's embedded browser (recommended to reduce interference)


---


## Step-by-step walkthrough


1. **Login and trigger a PATCH request**
- Open Burp's browser, navigate to the lab webapp and log in using:
- Username: `wiener`
- Password: `peter`
- Update your email address in the profile page (or set any profile field) to cause a `PATCH /api/user/wiener` request to be sent.


2. **Send to Repeater**
- In **Proxy > HTTP history**, locate the `PATCH /api/user/wiener` request.
- Right-click the entry and choose **Send to Repeater**.
- Switch to **Repeater** and resend the request. The response will contain data (e.g., credentials) for the user `wiener` — confirming the `/api/user/{username}` endpoint returns user data.


3. **Discover the documentation**
- In Repeater, remove `/wiener` from the path so it becomes `PATCH /api/user` and resend. You should receive an error indicating a user identifier is missing.
- Next, remove `/user` so the path is `PATCH /api` and resend. The response now returns API documentation (likely a JSON or HTML swagger-style document) instead of user data.
- Right-click the response and select **Show response in browser**. This opens the returned documentation in Burp’s browser and provides a URL you can copy.


4. **Open interactive docs and execute DELETE**
- Paste the copied documentation URL into Burp's browser address bar. You will see interactive documentation (e.g., Swagger UI or similar).
- Locate the `DELETE` operation for `/api/user/{username}` or similar. Use the UI to enter `carlos` as the username and click **Send request**.


5. **Verify success**
- The lab should indicate successful deletion of `carlos`.


---


## PoC (Burp Repeater style)


## 1. In Burp's browser, log in to the application using the credentials wiener:peter and update your email address:
    - Launch the Lab in Burp's embedded browser,
    - Click on **my account** and Log in with `wiener:peter`,
    - Enter email.
   
## 2. In Proxy > HTTP history, right-click the PATCH /api/user/wiener request and select Send to Repeater:
    - Now go to the Burp Suite and Proxy > HTTP history, right-click the PATCH /api/user/wiener request, right click on it and select Send to Repeater.
    
    - You can see like this :-

 ## <img width="1901" height="406" alt="image" src="https://github.com/user-attachments/assets/b95bd48c-343b-4e0a-8ce1-b0df67352da2" />
 
 ---
 ---

    - After Right Click You can see like this and Click on Send to Repeater :-

  ## <img width="1892" height="526" alt="image" src="https://github.com/user-attachments/assets/541eede5-384d-4c98-8e30-8a54469afc5a" />
 
 ---
 ---

## 3. Go to the Repeater tab. Send the PATCH /api/user/wiener request. Notice that this retrieves credentials for the user wiener:
    - Go to the Repeater tab,
    - You can see like this :-

  ## <img width="1848" height="842" alt="image" src="https://github.com/user-attachments/assets/5f42721d-2fc1-498e-ad7c-3f3ed8558a15" />

---
---

    - Send the PATCH /api/user/wiener request and Notice that this retrieves credentials for the user wiener:
    - You can see like this :-

  ## <img width="1475" height="902" alt="image" src="https://github.com/user-attachments/assets/e917b515-2bb8-45d5-b4b7-13db3e0626f5" />

---
---

## 4. Remove `/wiener` from the path of the request, so the endpoint is now `/api/user`, then send the request. Notice that this returns an error because there is no user identifier: 
    - Removing `/wiener` from the path and send the request.
    - We can notice that this returns an error because there is no user identifier.
  ## <img width="1472" height="902" alt="image" src="https://github.com/user-attachments/assets/705779ef-bccf-4be4-aef8-349751fe1fb6" />


  ---
  ---

## 5. Remove `/user` from the path of the request, so the endpoint is now `/api`, then send the request. Notice that this retrieves API documentation:
    - Remove `/user` from the path and send the request.
    - We can notice that this retrieves API documentation.

  ## <img width="1468" height="906" alt="image" src="https://github.com/user-attachments/assets/1bd3f702-6f09-48d1-a3d0-d1e01dd3905c" />

---
---

    - We can check the api document in GUI too, By using the /api.
  ## <img width="1026" height="927" alt="image" src="https://github.com/user-attachments/assets/363a3597-a9f8-4260-b579-289e79c925fc" />

---
---

## 6. To delete `Carlos` and solve the lab, click on the DELETE row, enter carlos, then click Send request.
    - Change the `PATCH` to `DELETE` and change the path and remove the email in line 20. Like this :-
  ## <img width="737" height="847" alt="image" src="https://github.com/user-attachments/assets/5ea11688-2896-42bd-86a5-12ef9f92ad14" />

---
---
 
    - Click on send.
  ## <img width="1477" height="902" alt="image" src="https://github.com/user-attachments/assets/f458bf7a-76e4-49a2-aac9-4399b4421616" />

---     
---

**The lab is Completed.**
